
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Animal, Vegetable, or Mineral?</title>
  <meta name="author" content="Jonathan Camenisch">

  
  <meta name="description" content="Animal, Vegetable, or Mineral? wherein prototypal inheritance models the universe in JavaScript First, a root object: var thing = {&#x000A; location &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jcamenisch.github.com/prototypes-in-javascript/">
  <link href="/prototypes-in-javascript/favicon.png" rel="icon">
  <link href="/prototypes-in-javascript/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/prototypes-in-javascript/javascripts/lib.js"></script>
  <script src="/prototypes-in-javascript/javascripts/slide_show.js"></script>
  <link href="/prototypes-in-javascript/atom.xml" rel="alternate" title="Animal, Vegetable, or Mineral?" type="application/atom+xml">
  
  

</head>
<body>
  <div id="main">
    <div class='page'>
  <div class='header'>
    <h1>Animal, Vegetable, or Mineral?</h1>
    <p>wherein prototypal inheritance models the universe in JavaScript</p>
  </div>
</div>
<div class='page'>
  <h3>First, a root object:</h3>
  <pre>var thing = {&#x000A;  location: 'the universe',&#x000A;  organic: false,&#x000A;  motile: false&#x000A;};</pre>
  <div class='header'>
    <h3>Then, to inherit from thing.</h3>
    <p>The old-fashioned way takes 3 lines:</p>
  </div>
  <pre>var ConstructThing = function(){};</pre>
  <pre>ConstructThing.prototype = thing;</pre>
  <pre>var mineral = new ConstructThing();</pre>
  <pre>mineral;</pre>
  <pre>mineral.location;</pre>
  <pre>mineral.organic;</pre>
  <pre>mineral.motile;</pre>
  <pre>Object.getPrototypeOf(mineral); /* ECMAScript 5 */</pre>
  <h3>We could have the constructor do something:</h3>
  <pre>var ConstructThing = function() {&#x000A;  this.createdAt = (new Date).toTimeString();&#x000A;};</pre>
  <pre>ConstructThing.prototype = thing;</pre>
  <pre>mineral = new ConstructThing();</pre>
  <h3>Moving along to the rest of the universe</h3>
  <pre>var ConstructMineral = function(){};</pre>
  <pre>ConstructMineral.prototype = mineral;</pre>
  <pre>var organism = new ConstructThing();</pre>
  <pre>organism.organic = true;</pre>
  <pre>var ConstructOrganism = function(){};</pre>
  <pre>ConstructOrganism.prototype = organism;</pre>
  <pre>var vegetable = new ConstructOrganism;</pre>
  <pre>var ConstructVegetable = function(){};</pre>
  <pre>ConstructVegetable.prototype = vegetable;</pre>
  <pre>var animal = new ConstructOrganism;</pre>
  <pre>animal.motile = true;</pre>
  <pre>var ConstructAnimal = function(){};</pre>
  <pre>ConstructAnimal.prototype = animal;</pre>
  <pre>var caveMan = new ConstructAnimal;</pre>
  <pre>var club = new ConstructVegetable;</pre>
  <pre>var rock = new ConstructMineral;</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.location });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.organic });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.motile });</pre>
</div>
<div class='page'>
  <h3>
    Problems with this approach:
  </h3>
  <ol class='split'>
    <li>It&#8217;s rather awkward (verbose, and conflicted).</li>
    <li>
      The danger of forgetting &#8220;new&#8221;:
      <pre>var OtherWindow = function(location) {&#x000A;  this.location = location;&#x000A;};&#x000A;var anotherWindow = new OtherWindow('http://google.com'); // fine&#x000A;var anotherWindow = OtherWindow('http://google.com');     // doh!</pre>
    </li>
    <li class='split'>
      <p>Constructors are not inheritable:</p>
      <pre>[caveMan, club, rock].map(function(o) { return o.createdAt });</pre>
      <pre>[organism, mineral].map(function(o) { return o.createdAt });</pre>
    </li>
  </ol>
</div>
<div class='page'>
  <h3>Why use inheritance at all?</h3>
  <ul class='split'>
    <li>Memory efficiency FTW! (or not)</li>
    <li>Super-quick creation of objects (for what it’s worth)</li>
    <li>Simple & clean model for code reuse</li>
  </ul>
  <h3>In any case</h3>
  <p>
    If you use inheritance in JavaScript, consider using prototypes directly.
  </p>
</div>
<div class='page'>
  <div class='header'>
    <h3>Could there be a less awkward way to inherit?</h3>
    <p>One great answer: ECMAScript5 gives us:</p>
  </div>
  <pre>var something = Object.create(thing);</pre>
  <p>We can easily backport this (see <a href="http://javascript.crockford.com/prototypal.html">javascript.crockford.com/prototypal.html</a>):</p>
  <pre>Object.create = function (proto) {&#x000A;  function Constructor() {}&#x000A;  Constructor.prototype = proto;&#x000A;  return new Constructor();&#x000A;};</pre>
  <h2>Let&#8217;s set up that taxonomy up again.</h2>
  <pre>var thing = {&#x000A;  location: 'the universe',&#x000A;  organic: false,&#x000A;  motile: false&#x000A;};</pre>
  <pre>mineral = Object.create(thing);</pre>
  <pre>organism = Object.create(thing);</pre>
  <pre>organism.organic = true;</pre>
  <pre>vegetable = Object.create(organism);</pre>
  <pre>animal = Object.create(organism);</pre>
  <pre>animal.motile = true;</pre>
  <pre>caveMan = Object.create(animal);</pre>
  <pre>club = Object.create(vegetable);</pre>
  <pre>rock = Object.create(mineral);</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.location });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.organic });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.motile });</pre>
</div>
<div class='page'>
  <h2>What about constructors?</h2>
  <p>
    A simple proposal (inspired by
    <a href='http://javascript.crockford.com/prototypal.html'>Crockford</a>
    ):
  </p>
  <pre>thing.initialize = function() {&#x000A;  this.createdAt = (new Date).toTimeString();&#x000A;};</pre>
  <pre>thing.beget = function() {&#x000A;  var begotten = Object.create(this);&#x000A;  begotten.initialize();&#x000A;  return begotten;&#x000A;};</pre>
  <pre>mineral = thing.beget();</pre>
  <pre>mineral.location;</pre>
  <h2>A step further:</h2>
  <p>Target: provide for initializing properties with</p>
  <pre>// something = thing.beget({prop: 'value', ...});</pre>
  <pre>thing.beget = function(properties) {&#x000A;  var begotten = Object.create(this);&#x000A;  begotten.initialize();&#x000A;  for (key in properties) {&#x000A;    if (properties.hasOwnProperty(key)) {&#x000A;      begotten[key] = properties[key];&#x000A;    }&#x000A;  }&#x000A;  return begotten;&#x000A;};</pre>
  <pre>mineral = thing.beget();</pre>
  <pre>organism = thing.beget({organic: true});</pre>
  <pre>vegetable = organism.beget();</pre>
  <pre>animal = organism.beget({motile: true});</pre>
  <pre>caveMan = animal.beget({name: 'Igor'});</pre>
  <pre>club = vegetable.beget({length: '2 cubits'});</pre>
  <pre>rock = mineral.beget({weight: '50 lbs'});</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.location });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.organic });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.motile });</pre>
  <pre>[caveMan, club, rock].map(function(o) { return o.createdAt });&#x000A;</pre>
</div>
<div class='page'>
  <div>
    <h2>Recommended Reading</h2>
    <ul>
    <li>See the <a href="/prototypes-in-javascript/javascripts/slide_show.js">Source code</a> to this slide deck for a less contrived example.</li>
    <li><a href="http://yehudakatz.com/2011/08/12/understanding-prototypes-in-javascript/">Understanding “Prototypes” in JavaScript</a>, Yehuda Katz</li>
    <li><a href="http://ejohn.org/blog/simple-javascript-inheritance/">Simple JavaScript Inheritance</a>, John Resig</li>
    <li><a href="http://joost.zeekat.nl/constructors-considered-mildly-confusing.html">Constructors considered mildly confusing</a> by Joost Diepenmaat, Zeekat Softwareontwikkeling</li>
    </ul>
    <h2>About</h2>
    <ul>
    <li>This presentation: <a href="http://jcamenisch.github.com/prototypes-in-javascript/">http://jcamenisch.github.com/prototypes-in-javascript/</a></li>
    <li>Find me online: <a href="http://github.com/jcamenisch">http://github.com/jcamenisch</a></li>
    </ul>
  </div>
</div>

  </div>
  


</body>
</html>
